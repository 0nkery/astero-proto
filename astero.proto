syntax = "proto2";

package astero;

// Helper structs (not messages)

message Coord {
    required float x = 1;
    required float y = 2;
}

message Asteroid {
    required Coord pos = 1;
    required Coord velocity = 2;
    required float life = 5;
}

message Asteroids {
    map<uint32, Asteroid> entities = 1;
}


// Actual messages

message Join {
    required string nickname = 1;
}

message JoinAck {
    required uint32 id = 1;
    required Coord pos = 2;
}

message OtherJoined {
    required uint32 id = 1;
    required string nickname = 2;
    required Coord pos = 3;
}


message Leave {}

message OtherLeft {
    required uint32 id = 1;
}


message Spawn {
    oneof entity {
        Asteroids asteroids = 1;
    }
}


message Heartbeat {}


// Message wrapper

message Client {
    oneof msg {
        Join join = 1;
        Leave leave = 2;
        Heartbeat heartbeat = 3;
    }
}

message Server {
    oneof msg {
        JoinAck join_ack = 1;
        OtherJoined other_joined = 2;
        OtherLeft other_left = 3;
        Spawn spawn = 4;
        Heartbeat heartbeat = 5;
    }
}
