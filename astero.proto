syntax = "proto3";

package astero;

// Helper structs (not messages)

message Coord {
    float x = 1;
    float y = 2;
}

message Asteroid {
    Coord pos = 1;
    Coord velocity = 2;
    float facing = 3;
    float rvel = 4;
    float life = 5;
}

message Asteroids {
    repeated Asteroid asteroids = 1;
}


// Actual messages

message Join {
    string nickname = 1;
}

message JoinAck {
    int32 id = 1;
    Coord pos = 2;
}

message OtherJoined {
    int32 id = 1;
    string nickname = 2;
    Coord pos = 3;
}


message Leave {}

message OtherLeft {
    int32 id = 1;
}


message Spawn {
    enum Kind {
        UNKNOWN = 0;
        ASTEROID = 1;
    }
    oneof entity {
        Asteroids asteroids = 1;
    }
}


message Heartbeat {}


// Message wrapper

message Message {
    enum Kind {
        UNKNOWN = 0;
        JOIN = 1;
        JOIN_ACK = 2;
        OTHER_JOINED = 3;
        LEAVE = 4;
        OTHER_LEFT = 5;
        SPAWN_ASTEROID = 6;
    }
    oneof msg {
        Join join = 1;
        JoinAck join_ack = 2;
        OtherJoined other_joined = 3;
        Leave leave = 4;
        OtherLeft other_left = 5;
        Spawn spawn = 6;
    }
}
