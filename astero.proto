syntax = "proto3";

package astero;

// Helper structs (not messages)

message Coord {
    float x = 1;
    float y = 2;
}

message Asteroid {
    int32 id = 1;
    Coord pos = 2;
    Coord velocity = 3;
    float facing = 4;
    float rvel = 5;
    float life = 6;
}

message Asteroids {
    repeated Asteroid asteroids = 1;
}


// Actual messages

message Join {
    string nickname = 1;
}

message JoinAck {
    int32 id = 1;
    Coord pos = 2;
}

message OtherJoined {
    int32 id = 1;
    string nickname = 2;
    Coord pos = 3;
}


message Leave {}

message OtherLeft {
    int32 id = 1;
}


message Spawn {
    oneof entity {
        Asteroids asteroids = 1;
    }
}


message Heartbeat {}


// Message wrapper

message Client {
    oneof msg {
        Join join = 1;
        Leave leave = 2;
        Heartbeat heartbeat = 3;
    }
}

message Server {
    oneof msg {
        JoinAck join_ack = 1;
        OtherJoined other_joined = 2;
        OtherLeft other_left = 3;
        Spawn spawn = 4;
        Heartbeat heartbeat = 5;
    }
}
